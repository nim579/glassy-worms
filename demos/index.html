<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="content-type" content="text/html; charset=utf-8">
        <title>Glassy worms</title>

        <link rel="stylesheet" type="text/css" href="../static/global.css">

        <script type="text/javascript" src="https://yastatic.net/jquery/3.1.1/jquery.min.js"></script>
        <script type="text/javascript" src="https://soulwire.github.io/sketch.js/js/sketch.min.js"></script>
        <script type="text/javascript" src="../builds/glassyWorms.js"></script>

        <script type="text/javascript">
            $(function(){
                var runTO = null;

                function run(params){
                    if(!params) params = getFields();
                    $('.demo__container').glassyWorms(params);
                    if(params.background) $('.demo__container').css('background', params.background);
                }
                function delayRun(){
                    clearTimeout(runTO);
                    runTO = setTimeout(run, 1000);
                }
                function getFields(){
                    var raw = $('form').serializeArray();
                    var data = {};
                    for(var i=0; i<raw.length; i++){
                        var val = raw[i].value;
                        try{val = JSON.parse(val)} catch(e){}''
                        if(val) data[raw[i].name] = val;
                    }
                    if(data.colors){
                        data.colors = data.colors.match(/#(\w{3,6})/g);
                    }
                    return data;
                }
                run();

                $('form').bind('submit', function(e){
                    e.preventDefault();
                    delayRun();
                    return true
                });
                $('input').bind('input', function(){
                    delayRun();
                    return true;
                });
            });
        </script>

        <style type="text/css">
            html, body {
                background: #000000;
            }
        </style>
    </head>
    <body>
        <div class="demo">
            <div class="panel">
                <form class="panel__form">
                    <div class="panel__field">
                        <label>numParticles</label><input type="number" name="numParticles" value="0" min="0" max="1000" />
                    </div>
                    <div class="panel__field">
                        <label>tailLength</label><input type="number" name="tailLength" value="12" min="1" max="9000" />
                    </div>
                    <div class="panel__field">
                        <label>maxForce</label><input type="number" name="maxForce" value="8" min="0" max="9000" />
                    </div>
                    <div class="panel__field">
                        <label>friction</label><input type="number" name="friction" value="0.75" min="0" max="1" />
                    </div>
                    <div class="panel__field">
                        <label>gravity</label><input type="number" name="gravity" value="9.81" min="0" max="9000" />
                    </div>
                    <div class="panel__field">
                        <label>interval</label><input type="number" name="interval" value="3" min="0" max="9000" />
                    </div>
                    <div class="panel__field">
                        <label>colors</label><input type="text" name="colors" value="#FFFFFF" />
                    </div>
                    <div class="panel__field">
                        <label>background</label><input type="text" name="background" value="#000000" />
                    </div>
                </form>
            </div>
            <div class="demo__container"></div>
        </div>
    </body>
</html>
