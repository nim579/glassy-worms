// Plugin glassy-worms. Beautiful worms on background
// Author: Nick Iv. Sorced 17 May 2014
// Site: http://dev.nim579.ru/glassy-worms
// Version: 1.0.0 (Thu Jun 15 2017 15:51:52)

(function(){var t,s,i,e,r;r||"object"!=typeof self||self.self!==self||(r=self),r||"object"!=typeof global||global.global!==global||(r=global),t=null,s=null,e=null,"function"==typeof define&&define.amd?define(["jquery","sketch-js","exports"],function(i,r,n){return t=i,s=r,e=n}):"undefined"!=typeof exports?(t=require("jquery"),s=require("sketch-js"),e=exports):(t=r.$,s=r.Sketch,e=r),(i={}).unique=function(){return null==this._i&&(this._i=0),++this._i},s.install(i),e.GlassyWormsParticle=function(){return function(t,s,e,r){this.x=null!=t?t:0,this.y=null!=s?s:0,this.mass=null!=e?e:1,null==r&&(r=["#000000"]),this.tail=[],this.radius=.15*this.mass,this.charge=i.random([-1,1]),this.color=i.random(r),this.fx=this.fy=0,this.vx=this.vy=0}}(),e.GlassyWorms=function(){function r(s,e){null==e&&(e={}),(e=t.extend(this.defaults(),e)).id&&(e.element.id=e.id),e.className&&e.element.classList.toggle(e.className,!0),e.useStyles&&t(e.element).css({position:"absolute",top:"0",left:"0",width:"100%",height:"100%"}),this.id=i.unique(),this.el=s,this.options=e,this.init(),t(window).bind("resize.glassyWorms"+this.id,function(t){return function(s){return t.onResize(s)}}(this))}return r.prototype.defaults=function(){return{numParticles:"auto",tailLength:12,maxForce:8,friction:.75,gravity:9.81,interval:3,colors:["#FFFFFF"],element:document.createElement("canvas"),useStyles:!0,retina:!0}},r.prototype.init=function(){var t;return t=this,this._sketch&&(this._sketch.destroy(),delete this._sketch),this._sketch=s.create({container:this.el,element:this.options.element,particles:[],interval:this.options.interval,params:this.options,setup:function(){return t._setup.apply(this,arguments)},draw:function(){return t._draw.apply(this,arguments)}})},r.prototype.start=function(){var t;return null!=(t=this._sketch)?t.start.apply(this._sketch,arguments):void 0},r.prototype.stop=function(){var t;return null!=(t=this._sketch)?t.stop.apply(this._sketch,arguments):void 0},r.prototype.toggle=function(){var t;return null!=(t=this._sketch)?t.toggle.apply(this._sketch,arguments):void 0},r.prototype.clear=function(){var t;return null!=(t=this._sketch)?t.clear.apply(this._sketch,arguments):void 0},r.prototype.setup=function(){var t;return null!=(t=this._sketch)?t.setup.apply(this._sketch,arguments):void 0},r.prototype.draw=function(){var t;return null!=(t=this._sketch)?t.draw.apply(this._sketch,arguments):void 0},r.prototype.destroy=function(){var s;return t(window).unbind(".glassyWorms"+this.id),null!=(s=this._sketch)&&s.destroy.apply(this._sketch,arguments),delete this._sketch},r.prototype.onResize=function(){return this.stop(),this._resizeTO&&clearTimeout(this._resizeTO),this._resizeTO=setTimeout(function(t){return function(){return t.clear(),t.setup(),t.start()}}(this),100)},r.prototype._setup=function(){var t,s,r,n,o,a;for(this.particles=[],n=[],t=0,r="auto"===this.params.numParticles?Math.round(i.sqrt(this.width*this.height/this.params.gravity)):this.params.numParticles;0<=r?t<r:t>r;0<=r?++t:--t)o=i.random(this.width),a=i.random(this.height),s=i.random(8,14),n.push(this.particles.push(new e.GlassyWormsParticle(o,a,s,this.params.colors)));return n},r.prototype._draw=function(){var t,s,e,r,n,o,a,h,l,u,c,p,y,f,d,m,g,v,_,x,k,w,W;for(this.lineCap=this.lineJoin="round",W=[],u=p=0,d=(x=this.particles).length;p<d;u=++p){for(t=x[u],i.random()<.5&&(t.charge=-t.charge),c=y=0,m=(k=this.particles.slice(u+1)).length;y<m;c=++y)n=(s=k[c]).x-t.x,o=s.y-t.y,(r=i.sqrt(e=n*n+o*o+.1))>=t.radius+s.radius&&(h=n*(f=1/r),l=o*f,a=i.min(this.params.maxForce,this.params.gravity*t.mass*s.mass/e),t.fx+=a*h*s.charge,t.fy+=a*l*s.charge,s.fx+=-a*h*t.charge,s.fy+=-a*l*t.charge);for(t.vx+=t.fx,t.vy+=t.fy,t.vx*=this.params.friction,t.vy*=this.params.friction,t.tail.unshift({x:t.x,y:t.y}),t.tail.length>this.params.tailLength&&t.tail.pop(),t.x+=t.vx,t.y+=t.vy,t.fx=t.fy=0,t.x>this.width+t.radius?(t.x=-t.radius,t.tail=[]):t.x<-t.radius&&(t.x=this.width+t.radius,t.tail=[]),t.y>this.height+t.radius?(t.y=-t.radius,t.tail=[]):t.y<-t.radius&&(t.y=this.height+t.radius,t.tail=[]),this.strokeStyle=t.color,this.lineWidth=.1*t.radius,this.beginPath(),this.moveTo(t.x,t.y),v=0,g=(w=t.tail).length;v<g;v++)_=w[v],this.lineTo(_.x,_.y);W.push(this.stroke())}return W},r}(),t.fn.glassyWorms=function(t){return"string"==typeof t?(this.each(function(s,i){var e;if(null!=(e=i.glassyWorms)&&"function"==typeof e[t]&&e[t](),"destroy"===t)return delete i.glassyWorms}),this):(this.each(function(s,i){return i.glassyWorms&&(i.glassyWorms.destroy(),delete i.glassyWorms),i.glassyWorms=new e.GlassyWorms(i,t)}),this)}}).call(this);